ctit084
2024-04-12 11:25:03.441149: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-04-12 11:25:04.096741: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-12 11:25:05.923770: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
INFO flwr 2024-04-12 11:25:16,288 | batch_run_simulation.py:80 | Loaded 36 configs with name MINST-2NN-FEDADAM, running...
INFO flwr 2024-04-12 11:25:16,288 | run_simulation.py:153 | 
Running with Config
	Simulation
		batch_size: 8
		client_count: 100
		fraction_fit: 0.1
		global_rounds: 10
		local_rounds: 10
		Optimizer: FedAdam
			local: {'lr': [0.15, 0.2, 0.25]}
			global: {'lr': 0.05, 'betas': [0.9, 0.99], 'eps': 1e-08, 'weight_decay': 0.9999}
	Dataset
		name: MNIST
		preprocess_fn:
			def preprocess_fn(element):
			  return {
			    "x": element["image"].reshape(784) / 255.,
			    "y": element["label"]
			  }
			
		splitter:
			alpha: 1.0
			percent_non_iid: 25.0
	Model
		name: Logistic Regression
		criterion: CrossEntropyLoss()
		layers:
			Net(
			  (layers): Sequential(
			    (0): Linear(in_features=784, out_features=10, bias=True)
			    (1): Softmax(dim=-1)
			  )
			)
Using the latest cached version of the dataset since mnist couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'mnist' at .cache/mnist/mnist/1.0.0/b06aab39e05f7bcd9635d18ed25d06eae523c574 (last modified on Tue Apr  2 18:09:57 2024).
wandb: Tracking run with wandb version 0.16.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
INFO flwr 2024-04-12 11:32:35,713 | app.py:178 | Starting Flower simulation, config: ServerConfig(num_rounds=10, round_timeout=None)
2024-04-12 11:32:44,771	INFO worker.py:1621 -- Started a local Ray instance.
2024-04-12 11:33:01,106	INFO packaging.py:518 -- Creating a file package for local directory '/home/s2240084/conFEDential'.
2024-04-12 11:33:01,570	INFO packaging.py:346 -- Pushing file package 'gcs://_ray_pkg_57db9ab65c7076c7.zip' (12.69MiB) to Ray cluster...
2024-04-12 11:33:01,613	INFO packaging.py:359 -- Successfully pushed file package 'gcs://_ray_pkg_57db9ab65c7076c7.zip'.
INFO flwr 2024-04-12 11:33:12,425 | app.py:213 | Flower VCE: Ray initialized with resources: {'memory': 171834976871.0, 'accelerator_type:RTX': 1.0, 'object_store_memory': 77929275801.0, 'CPU': 64.0, 'GPU': 1.0, 'node:10.20.240.14': 1.0, 'node:__internal_head__': 1.0}
INFO flwr 2024-04-12 11:33:12,425 | app.py:219 | Optimize your simulation with Flower VCE: https://flower.dev/docs/framework/how-to-run-simulations.html
INFO flwr 2024-04-12 11:33:12,426 | app.py:242 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 0.125}
INFO flwr 2024-04-12 11:33:12,439 | app.py:288 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
INFO flwr 2024-04-12 11:33:12,440 | server.py:89 | Initializing global parameters
INFO flwr 2024-04-12 11:33:12,441 | server.py:272 | Using initial parameters provided by strategy
INFO flwr 2024-04-12 11:33:12,441 | server.py:91 | Evaluating initial parameters
[2m[36m(pid=1306590)[0m 2024-04-12 11:33:18.108397: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[2m[36m(pid=1306590)[0m 2024-04-12 11:33:18.231096: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[2m[36m(pid=1306590)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
INFO flwr 2024-04-12 11:33:21,429 | server.py:94 | initial parameters (loss, other metrics): 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}
INFO flwr 2024-04-12 11:33:21,430 | server.py:104 | FL starting
DEBUG flwr 2024-04-12 11:33:21,430 | server.py:222 | fit_round 1: strategy sampled 10 clients (out of 100)
[2m[36m(pid=1306590)[0m 2024-04-12 11:33:22.081607: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
ERROR flwr 2024-04-12 11:33:33,140 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,156 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,849 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,849 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,850 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,850 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,852 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,853 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,855 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,855 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,857 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,858 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,858 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,858 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,859 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,860 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 14 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:33,861 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:33,861 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 14 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:34,316 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 58 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:34,317 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 58 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:33:34,318 | server.py:236 | fit_round 1 received 0 results and 10 failures
INFO flwr 2024-04-12 11:33:35,518 | server.py:125 | fit progress: (1, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 14.088141168933362)
INFO flwr 2024-04-12 11:33:35,518 | server.py:171 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2024-04-12 11:33:35,518 | server.py:222 | fit_round 2: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:33:41,632 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:41,649 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,309 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 29 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,309 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 29 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,310 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,311 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,312 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,312 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,312 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,314 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,315 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,316 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,317 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,317 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,318 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,318 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,318 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,319 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:42,834 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:42,835 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:33:42,836 | server.py:236 | fit_round 2 received 0 results and 10 failures
INFO flwr 2024-04-12 11:33:44,036 | server.py:125 | fit progress: (2, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 22.606269765179604)
INFO flwr 2024-04-12 11:33:44,036 | server.py:171 | evaluate_round 2: no clients selected, cancel
DEBUG flwr 2024-04-12 11:33:44,036 | server.py:222 | fit_round 3: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:33:49,179 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:49,190 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 47 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:49,195 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:49,221 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 47 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:49,631 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 15 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:49,631 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 15 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:50,324 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 40 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:50,325 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 40 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:50,327 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:50,328 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:50,329 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:50,331 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:50,333 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:50,333 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:50,334 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:50,334 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:50,335 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:50,335 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:50,879 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 81 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:50,880 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 81 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:33:50,881 | server.py:236 | fit_round 3 received 0 results and 10 failures
INFO flwr 2024-04-12 11:33:52,047 | server.py:125 | fit progress: (3, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 30.61778697418049)
INFO flwr 2024-04-12 11:33:52,048 | server.py:171 | evaluate_round 3: no clients selected, cancel
DEBUG flwr 2024-04-12 11:33:52,048 | server.py:222 | fit_round 4: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:33:57,547 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 7 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:57,558 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 7 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,291 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,292 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,292 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,293 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,295 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,296 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,297 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,297 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 2 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,299 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,300 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 13 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,300 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 2 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,302 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,302 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,303 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 13 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,303 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,303 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:33:58,842 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:33:58,842 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:33:58,843 | server.py:236 | fit_round 4 received 0 results and 10 failures
INFO flwr 2024-04-12 11:34:00,045 | server.py:125 | fit progress: (4, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 38.61582470498979)
INFO flwr 2024-04-12 11:34:00,046 | server.py:171 | evaluate_round 4: no clients selected, cancel
DEBUG flwr 2024-04-12 11:34:00,046 | server.py:222 | fit_round 5: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:34:05,729 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 17 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:05,746 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 17 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,414 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,415 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,416 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,418 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,420 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 88 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,420 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,424 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 65 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,424 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,425 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 57 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,425 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,425 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 88 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,426 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,426 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 65 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,426 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,427 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 57 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,427 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:06,937 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:06,937 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:34:06,939 | server.py:236 | fit_round 5 received 0 results and 10 failures
INFO flwr 2024-04-12 11:34:08,125 | server.py:125 | fit progress: (5, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 46.6957803061232)
INFO flwr 2024-04-12 11:34:08,126 | server.py:171 | evaluate_round 5: no clients selected, cancel
DEBUG flwr 2024-04-12 11:34:08,126 | server.py:222 | fit_round 6: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:34:13,683 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:13,684 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:13,686 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:13,687 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,416 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,417 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,417 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,417 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 30 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,418 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 14 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,419 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,420 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,421 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,421 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 30 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,422 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,422 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 14 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,423 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,424 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,424 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:14,974 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:14,974 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:34:14,975 | server.py:236 | fit_round 6 received 0 results and 10 failures
INFO flwr 2024-04-12 11:34:16,135 | server.py:125 | fit progress: (6, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 54.705082789994776)
INFO flwr 2024-04-12 11:34:16,135 | server.py:171 | evaluate_round 6: no clients selected, cancel
DEBUG flwr 2024-04-12 11:34:16,135 | server.py:222 | fit_round 7: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:34:21,791 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:21,807 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,522 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 39 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,522 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 39 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,524 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,524 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,525 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 40 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,526 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 40 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,528 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 13 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,528 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,530 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 13 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,530 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,531 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,531 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,532 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,532 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 18 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:22,533 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:22,533 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 18 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:23,099 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:23,099 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:34:23,100 | server.py:236 | fit_round 7 received 0 results and 10 failures
INFO flwr 2024-04-12 11:34:24,297 | server.py:125 | fit progress: (7, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 62.86746305273846)
INFO flwr 2024-04-12 11:34:24,297 | server.py:171 | evaluate_round 7: no clients selected, cancel
DEBUG flwr 2024-04-12 11:34:24,297 | server.py:222 | fit_round 8: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:34:29,876 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 19 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:29,877 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 19 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,594 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,597 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,597 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,599 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,600 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,601 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 72 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,601 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,601 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 94 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,602 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,603 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,604 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 62 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:30,604 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 72 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,604 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,604 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 94 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,605 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:30,605 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 62 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:31,186 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 4 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:31,186 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 4 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:34:31,188 | server.py:236 | fit_round 8 received 0 results and 10 failures
INFO flwr 2024-04-12 11:34:32,379 | server.py:125 | fit progress: (8, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 70.94946534605697)
INFO flwr 2024-04-12 11:34:32,379 | server.py:171 | evaluate_round 8: no clients selected, cancel
DEBUG flwr 2024-04-12 11:34:32,379 | server.py:222 | fit_round 9: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:34:37,938 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 42 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:37,944 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 42 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,633 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,633 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 29 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,634 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 48 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,635 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 9 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,635 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,636 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 29 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,638 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 48 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,640 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 9 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,640 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,641 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,642 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 37 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,642 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:38,644 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,645 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,645 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 37 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:38,645 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:39,195 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 1 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:39,196 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 1 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:34:39,197 | server.py:236 | fit_round 9 received 0 results and 10 failures
INFO flwr 2024-04-12 11:34:40,400 | server.py:125 | fit progress: (9, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 78.97028360702097)
INFO flwr 2024-04-12 11:34:40,400 | server.py:171 | evaluate_round 9: no clients selected, cancel
DEBUG flwr 2024-04-12 11:34:40,400 | server.py:222 | fit_round 10: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:34:46,026 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,042 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,717 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,717 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,718 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 99 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,718 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306605, ip=10.20.240.14, actor_id=1731bcd91428d72d6325a29e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f0b7a7055d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,721 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306593, ip=10.20.240.14, actor_id=b2d75df3b01d4e9c3b1010eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f8e844914e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,722 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,723 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 45 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,723 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 99 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,723 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,726 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,727 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 63 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:46,727 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306602, ip=10.20.240.14, actor_id=876c979288d9411a40cf580301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f63cbbed510>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,728 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306590, ip=10.20.240.14, actor_id=b38ae69232c599095e7cd1f301000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd446159630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 45 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,728 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306610, ip=10.20.240.14, actor_id=51f42531e257b3e3bb8f823e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73677b1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,729 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306597, ip=10.20.240.14, actor_id=f6654bd6464a61fa3c4785a901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd5c98d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:46,729 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306592, ip=10.20.240.14, actor_id=57cd50080a8c8ef6ce4bfd3d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eebd8c9d6c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 63 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:34:47,293 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:34:47,293 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1306587, ip=10.20.240.14, actor_id=3f19899cbaea22d8a798557f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f75a9625630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-32-35_859137_1301826/runtime_resources/working_dir_files/_ray_pkg_57db9ab65c7076c7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:34:47,294 | server.py:236 | fit_round 10 received 0 results and 10 failures
INFO flwr 2024-04-12 11:34:48,450 | server.py:125 | fit progress: (10, 2.3044753074645996, {'accuracy': 0.0654, 'data_size': 10000}, 87.0206982367672)
INFO flwr 2024-04-12 11:34:48,451 | server.py:171 | evaluate_round 10: no clients selected, cancel
INFO flwr 2024-04-12 11:34:48,451 | server.py:153 | FL finished in 87.02108375076205
INFO flwr 2024-04-12 11:34:48,453 | app.py:226 | app_fit: losses_distributed []
INFO flwr 2024-04-12 11:34:48,453 | app.py:227 | app_fit: metrics_distributed_fit {}
INFO flwr 2024-04-12 11:34:48,453 | app.py:228 | app_fit: metrics_distributed {}
INFO flwr 2024-04-12 11:34:48,453 | app.py:229 | app_fit: losses_centralized [(0, 2.3044753074645996), (1, 2.3044753074645996), (2, 2.3044753074645996), (3, 2.3044753074645996), (4, 2.3044753074645996), (5, 2.3044753074645996), (6, 2.3044753074645996), (7, 2.3044753074645996), (8, 2.3044753074645996), (9, 2.3044753074645996), (10, 2.3044753074645996)]
INFO flwr 2024-04-12 11:34:48,453 | app.py:230 | app_fit: metrics_centralized {'accuracy': [(0, 0.0654), (1, 0.0654), (2, 0.0654), (3, 0.0654), (4, 0.0654), (5, 0.0654), (6, 0.0654), (7, 0.0654), (8, 0.0654), (9, 0.0654), (10, 0.0654)], 'data_size': [(0, 10000), (1, 10000), (2, 10000), (3, 10000), (4, 10000), (5, 10000), (6, 10000), (7, 10000), (8, 10000), (9, 10000), (10, 10000)]}
wandb: - 0.000 MB of 0.000 MB uploadedwandb:                                                                                
wandb: 
wandb: Run summary:
wandb: accuracy 0.0654
wandb:     loss 2.30448
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/s2240084/conFEDential/wandb/offline-run-20240412_113232-2excx2g2
wandb: Find logs at: ./wandb/offline-run-20240412_113232-2excx2g2/logs
INFO flwr 2024-04-12 11:34:51,852 | run_simulation.py:153 | 
Running with Config
	Simulation
		batch_size: 8
		client_count: 100
		fraction_fit: 0.1
		global_rounds: 10
		local_rounds: 10
		Optimizer: FedAdam
			local: {'lr': [0.15, 0.2, 0.25]}
			global: {'lr': 0.1, 'betas': [0.9, 0.99], 'eps': 1e-08, 'weight_decay': 0.9999}
	Dataset
		name: MNIST
		preprocess_fn:
			def preprocess_fn(element):
			  return {
			    "x": element["image"].reshape(784) / 255.,
			    "y": element["label"]
			  }
			
		splitter:
			alpha: 1.0
			percent_non_iid: 25.0
	Model
		name: Logistic Regression
		criterion: CrossEntropyLoss()
		layers:
			Net(
			  (layers): Sequential(
			    (0): Linear(in_features=784, out_features=10, bias=True)
			    (1): Softmax(dim=-1)
			  )
			)
Using the latest cached version of the dataset since mnist couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'mnist' at .cache/mnist/mnist/1.0.0/b06aab39e05f7bcd9635d18ed25d06eae523c574 (last modified on Tue Apr  2 18:09:57 2024).
wandb: Tracking run with wandb version 0.16.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
INFO flwr 2024-04-12 11:41:55,682 | app.py:178 | Starting Flower simulation, config: ServerConfig(num_rounds=10, round_timeout=None)
[2m[36m(pid=1306587)[0m 2024-04-12 11:33:18.108396: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[2m[36m(pid=1306605)[0m 2024-04-12 11:33:18.246612: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1306605)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1306587)[0m 2024-04-12 11:33:22.081598: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[32m [repeated 7x across cluster][0m
2024-04-12 11:42:00,062	INFO worker.py:1621 -- Started a local Ray instance.
2024-04-12 11:42:00,468	INFO packaging.py:518 -- Creating a file package for local directory '/home/s2240084/conFEDential'.
2024-04-12 11:42:00,888	INFO packaging.py:346 -- Pushing file package 'gcs://_ray_pkg_c13382d826d989e9.zip' (13.87MiB) to Ray cluster...
2024-04-12 11:42:00,937	INFO packaging.py:359 -- Successfully pushed file package 'gcs://_ray_pkg_c13382d826d989e9.zip'.
INFO flwr 2024-04-12 11:42:10,335 | app.py:213 | Flower VCE: Ray initialized with resources: {'memory': 170264771994.0, 'node:__internal_head__': 1.0, 'object_store_memory': 77256330854.0, 'accelerator_type:RTX': 1.0, 'GPU': 1.0, 'node:10.20.240.14': 1.0, 'CPU': 64.0}
INFO flwr 2024-04-12 11:42:10,335 | app.py:219 | Optimize your simulation with Flower VCE: https://flower.dev/docs/framework/how-to-run-simulations.html
INFO flwr 2024-04-12 11:42:10,335 | app.py:242 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 0.125}
INFO flwr 2024-04-12 11:42:10,348 | app.py:288 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
INFO flwr 2024-04-12 11:42:10,349 | server.py:89 | Initializing global parameters
INFO flwr 2024-04-12 11:42:10,349 | server.py:272 | Using initial parameters provided by strategy
INFO flwr 2024-04-12 11:42:10,350 | server.py:91 | Evaluating initial parameters
INFO flwr 2024-04-12 11:42:12,996 | server.py:94 | initial parameters (loss, other metrics): 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}
INFO flwr 2024-04-12 11:42:13,010 | server.py:104 | FL starting
DEBUG flwr 2024-04-12 11:42:13,011 | server.py:222 | fit_round 1: strategy sampled 10 clients (out of 100)
[2m[36m(pid=1316814)[0m 2024-04-12 11:42:15.485960: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[2m[36m(pid=1316814)[0m 2024-04-12 11:42:15.574847: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[2m[36m(pid=1316814)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[2m[36m(pid=1316814)[0m 2024-04-12 11:42:17.418523: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
ERROR flwr 2024-04-12 11:42:26,414 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:26,420 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,017 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,018 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,019 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,019 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,020 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,021 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,025 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,026 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,027 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,027 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 36 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,029 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,030 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,031 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 36 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,032 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,033 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,033 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:27,466 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:27,466 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:42:27,467 | server.py:236 | fit_round 1 received 0 results and 10 failures
INFO flwr 2024-04-12 11:42:28,644 | server.py:125 | fit progress: (1, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 15.63294969405979)
INFO flwr 2024-04-12 11:42:28,644 | server.py:171 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2024-04-12 11:42:28,644 | server.py:222 | fit_round 2: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:42:34,805 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 88 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:34,822 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 88 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,537 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,539 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,539 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,541 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,543 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 78 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,544 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,545 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,546 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,546 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,546 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 79 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,547 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,547 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 78 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,548 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,549 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,549 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,550 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 79 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:35,770 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:35,771 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:42:35,772 | server.py:236 | fit_round 2 received 0 results and 10 failures
INFO flwr 2024-04-12 11:42:36,941 | server.py:125 | fit progress: (2, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 23.93062093667686)
INFO flwr 2024-04-12 11:42:36,941 | server.py:171 | evaluate_round 2: no clients selected, cancel
DEBUG flwr 2024-04-12 11:42:36,942 | server.py:222 | fit_round 3: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:42:42,694 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 66 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:42,700 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 66 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,435 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,436 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,437 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 23 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,437 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 79 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,438 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,438 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 23 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,440 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 36 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,440 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 79 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,440 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,442 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,442 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,443 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,443 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 36 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,444 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,444 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 86 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,445 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:43,679 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:43,680 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:42:43,681 | server.py:236 | fit_round 3 received 0 results and 10 failures
INFO flwr 2024-04-12 11:42:44,838 | server.py:125 | fit progress: (3, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 31.827408568002284)
INFO flwr 2024-04-12 11:42:44,838 | server.py:171 | evaluate_round 3: no clients selected, cancel
DEBUG flwr 2024-04-12 11:42:44,838 | server.py:222 | fit_round 4: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:42:50,373 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 77 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:50,374 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 77 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,091 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 39 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,091 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 57 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,092 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,092 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 39 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,093 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 76 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,094 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,094 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 57 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,095 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,096 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 76 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,096 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 82 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,097 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,097 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,099 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,100 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 82 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,101 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 3 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,101 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:51,599 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:51,600 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:42:51,601 | server.py:236 | fit_round 4 received 0 results and 10 failures
INFO flwr 2024-04-12 11:42:52,782 | server.py:125 | fit progress: (4, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 39.77145018381998)
INFO flwr 2024-04-12 11:42:52,782 | server.py:171 | evaluate_round 4: no clients selected, cancel
DEBUG flwr 2024-04-12 11:42:52,782 | server.py:222 | fit_round 5: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:42:58,526 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 31 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:58,527 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 31 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,217 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 76 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,218 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 76 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,219 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,219 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 19 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,220 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,221 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 58 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,221 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 19 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,223 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 58 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,224 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 34 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,226 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,228 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,227 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,226 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 34 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,228 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,228 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 96 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,229 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 96 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:42:59,775 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:42:59,776 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:42:59,777 | server.py:236 | fit_round 5 received 0 results and 10 failures
INFO flwr 2024-04-12 11:43:01,006 | server.py:125 | fit progress: (5, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 47.9953678236343)
INFO flwr 2024-04-12 11:43:01,006 | server.py:171 | evaluate_round 5: no clients selected, cancel
DEBUG flwr 2024-04-12 11:43:01,006 | server.py:222 | fit_round 6: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:43:06,556 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:06,556 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,289 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 57 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,289 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,290 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 57 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,290 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,292 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,292 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,294 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,294 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,294 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 31 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,297 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 18 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,297 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 31 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,299 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 18 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,300 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 4 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,301 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 98 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,301 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 4 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,302 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 98 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:07,836 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:07,836 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:43:07,837 | server.py:236 | fit_round 6 received 0 results and 10 failures
INFO flwr 2024-04-12 11:43:09,015 | server.py:125 | fit progress: (6, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 56.00399915361777)
INFO flwr 2024-04-12 11:43:09,015 | server.py:171 | evaluate_round 6: no clients selected, cancel
DEBUG flwr 2024-04-12 11:43:09,015 | server.py:222 | fit_round 7: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:43:14,639 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 15 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:14,639 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 15 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,380 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 22 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,380 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 22 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,384 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,385 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,386 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,387 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,388 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 77 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,388 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 7 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,389 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,389 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,390 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 9 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,390 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,391 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 77 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,391 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 7 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,392 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,392 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 9 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:15,948 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:15,949 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 26 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:43:15,950 | server.py:236 | fit_round 7 received 0 results and 10 failures
INFO flwr 2024-04-12 11:43:17,134 | server.py:125 | fit progress: (7, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 64.12380635598674)
INFO flwr 2024-04-12 11:43:17,135 | server.py:171 | evaluate_round 7: no clients selected, cancel
DEBUG flwr 2024-04-12 11:43:17,135 | server.py:222 | fit_round 8: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:43:22,665 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:22,665 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,337 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 71 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,338 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,338 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 45 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,339 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 71 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,339 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,341 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 97 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,341 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 45 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,344 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 97 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,348 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,348 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 58 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,349 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,349 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,349 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,350 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 58 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,350 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,350 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:23,943 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:23,943 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:43:23,944 | server.py:236 | fit_round 8 received 0 results and 10 failures
INFO flwr 2024-04-12 11:43:25,130 | server.py:125 | fit progress: (8, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 72.11901944177225)
INFO flwr 2024-04-12 11:43:25,130 | server.py:171 | evaluate_round 8: no clients selected, cancel
DEBUG flwr 2024-04-12 11:43:25,130 | server.py:222 | fit_round 9: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:43:30,813 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:30,813 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,582 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 75 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,583 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,583 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,585 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 75 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,587 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 35 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,587 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 34 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,588 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,589 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,590 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 7 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,590 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,590 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:31,591 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 35 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,591 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 34 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,592 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,592 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 7 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:31,593 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:32,120 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 90 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:32,121 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 90 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:43:32,122 | server.py:236 | fit_round 9 received 0 results and 10 failures
INFO flwr 2024-04-12 11:43:33,297 | server.py:125 | fit progress: (9, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 80.28659873083234)
INFO flwr 2024-04-12 11:43:33,297 | server.py:171 | evaluate_round 9: no clients selected, cancel
DEBUG flwr 2024-04-12 11:43:33,298 | server.py:222 | fit_round 10: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:43:38,971 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 60 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:38,988 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 60 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,700 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,700 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 71 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,701 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 63 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,701 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 87 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,702 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,703 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316814, ip=10.20.240.14, actor_id=1611695cf27d94822c55920001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eff1049d960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 71 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,704 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 42 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,704 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316827, ip=10.20.240.14, actor_id=335cf654fea48e16189fcfd101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f78baa79810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 63 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,706 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316816, ip=10.20.240.14, actor_id=2d8615a970dfcd8a3fff4ace01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9bf8ef15d0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 87 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,707 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,707 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,708 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:39,708 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316817, ip=10.20.240.14, actor_id=411bd434a3790de5b006f30901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f993d6dd600>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 42 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,709 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316822, ip=10.20.240.14, actor_id=45f14059b8550df75dc8f41f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f00c6ba1630>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,710 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316819, ip=10.20.240.14, actor_id=bbd24d638172ad6abcda714c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2fe9f97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:39,710 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316815, ip=10.20.240.14, actor_id=2f52bbccc67fbef1a5e734cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7eece78d9570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:43:40,240 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 37 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:43:40,240 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1316824, ip=10.20.240.14, actor_id=3c04644b15f64b6f23e321db01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd862855540>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 37 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-41-57_669937_1301826/runtime_resources/working_dir_files/_ray_pkg_c13382d826d989e9/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:43:40,241 | server.py:236 | fit_round 10 received 0 results and 10 failures
INFO flwr 2024-04-12 11:43:41,205 | server.py:125 | fit progress: (10, 2.3022866249084473, {'accuracy': 0.1039, 'data_size': 10000}, 88.19467876292765)
INFO flwr 2024-04-12 11:43:41,205 | server.py:171 | evaluate_round 10: no clients selected, cancel
INFO flwr 2024-04-12 11:43:41,206 | server.py:153 | FL finished in 88.19502859283239
INFO flwr 2024-04-12 11:43:41,206 | app.py:226 | app_fit: losses_distributed []
INFO flwr 2024-04-12 11:43:41,206 | app.py:227 | app_fit: metrics_distributed_fit {}
INFO flwr 2024-04-12 11:43:41,206 | app.py:228 | app_fit: metrics_distributed {}
INFO flwr 2024-04-12 11:43:41,206 | app.py:229 | app_fit: losses_centralized [(0, 2.3022866249084473), (1, 2.3022866249084473), (2, 2.3022866249084473), (3, 2.3022866249084473), (4, 2.3022866249084473), (5, 2.3022866249084473), (6, 2.3022866249084473), (7, 2.3022866249084473), (8, 2.3022866249084473), (9, 2.3022866249084473), (10, 2.3022866249084473)]
INFO flwr 2024-04-12 11:43:41,206 | app.py:230 | app_fit: metrics_centralized {'accuracy': [(0, 0.1039), (1, 0.1039), (2, 0.1039), (3, 0.1039), (4, 0.1039), (5, 0.1039), (6, 0.1039), (7, 0.1039), (8, 0.1039), (9, 0.1039), (10, 0.1039)], 'data_size': [(0, 10000), (1, 10000), (2, 10000), (3, 10000), (4, 10000), (5, 10000), (6, 10000), (7, 10000), (8, 10000), (9, 10000), (10, 10000)]}
wandb: - 0.000 MB of 0.000 MB uploadedwandb:                                                                                
wandb: 
wandb: Run summary:
wandb: accuracy 0.1039
wandb:     loss 2.30229
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/s2240084/conFEDential/wandb/offline-run-20240412_114155-4tuhl8fk
wandb: Find logs at: ./wandb/offline-run-20240412_114155-4tuhl8fk/logs
INFO flwr 2024-04-12 11:43:44,637 | run_simulation.py:153 | 
Running with Config
	Simulation
		batch_size: 8
		client_count: 100
		fraction_fit: 0.1
		global_rounds: 10
		local_rounds: 10
		Optimizer: FedAdam
			local: {'lr': [0.15, 0.2, 0.25]}
			global: {'lr': 0.2, 'betas': [0.9, 0.99], 'eps': 1e-08, 'weight_decay': 0.9999}
	Dataset
		name: MNIST
		preprocess_fn:
			def preprocess_fn(element):
			  return {
			    "x": element["image"].reshape(784) / 255.,
			    "y": element["label"]
			  }
			
		splitter:
			alpha: 1.0
			percent_non_iid: 25.0
	Model
		name: Logistic Regression
		criterion: CrossEntropyLoss()
		layers:
			Net(
			  (layers): Sequential(
			    (0): Linear(in_features=784, out_features=10, bias=True)
			    (1): Softmax(dim=-1)
			  )
			)
Using the latest cached version of the dataset since mnist couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'mnist' at .cache/mnist/mnist/1.0.0/b06aab39e05f7bcd9635d18ed25d06eae523c574 (last modified on Tue Apr  2 18:09:57 2024).
wandb: Tracking run with wandb version 0.16.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
INFO flwr 2024-04-12 11:50:48,414 | app.py:178 | Starting Flower simulation, config: ServerConfig(num_rounds=10, round_timeout=None)
[2m[36m(pid=1316816)[0m 2024-04-12 11:42:15.830061: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1316816)[0m 2024-04-12 11:42:15.917553: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1316816)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1316816)[0m 2024-04-12 11:42:17.838661: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[32m [repeated 7x across cluster][0m
2024-04-12 11:50:52,886	INFO worker.py:1621 -- Started a local Ray instance.
2024-04-12 11:50:53,314	INFO packaging.py:518 -- Creating a file package for local directory '/home/s2240084/conFEDential'.
2024-04-12 11:50:53,773	INFO packaging.py:346 -- Pushing file package 'gcs://_ray_pkg_ce7684eb240d79e7.zip' (15.05MiB) to Ray cluster...
2024-04-12 11:50:53,822	INFO packaging.py:359 -- Successfully pushed file package 'gcs://_ray_pkg_ce7684eb240d79e7.zip'.
INFO flwr 2024-04-12 11:51:03,266 | app.py:213 | Flower VCE: Ray initialized with resources: {'CPU': 64.0, 'accelerator_type:RTX': 1.0, 'object_store_memory': 77723767603.0, 'node:10.20.240.14': 1.0, 'GPU': 1.0, 'memory': 171355457741.0, 'node:__internal_head__': 1.0}
INFO flwr 2024-04-12 11:51:03,266 | app.py:219 | Optimize your simulation with Flower VCE: https://flower.dev/docs/framework/how-to-run-simulations.html
INFO flwr 2024-04-12 11:51:03,266 | app.py:242 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 0.125}
INFO flwr 2024-04-12 11:51:03,280 | app.py:288 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
INFO flwr 2024-04-12 11:51:03,281 | server.py:89 | Initializing global parameters
INFO flwr 2024-04-12 11:51:03,282 | server.py:272 | Using initial parameters provided by strategy
INFO flwr 2024-04-12 11:51:03,282 | server.py:91 | Evaluating initial parameters
INFO flwr 2024-04-12 11:51:06,329 | server.py:94 | initial parameters (loss, other metrics): 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}
INFO flwr 2024-04-12 11:51:06,338 | server.py:104 | FL starting
DEBUG flwr 2024-04-12 11:51:06,339 | server.py:222 | fit_round 1: strategy sampled 10 clients (out of 100)
[2m[36m(pid=1323585)[0m 2024-04-12 11:51:08.495365: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[2m[36m(pid=1323585)[0m 2024-04-12 11:51:08.588631: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[2m[36m(pid=1323585)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[2m[36m(pid=1323585)[0m 2024-04-12 11:51:10.440964: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
ERROR flwr 2024-04-12 11:51:20,122 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,138 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,903 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,904 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,907 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,908 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,910 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,911 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,912 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,913 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,914 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,915 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 52 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,917 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 79 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,917 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,917 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 79 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,918 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:20,918 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:20,919 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:21,385 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:21,386 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 56 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:51:21,387 | server.py:236 | fit_round 1 received 0 results and 10 failures
INFO flwr 2024-04-12 11:51:22,569 | server.py:125 | fit progress: (1, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 16.229961465578526)
INFO flwr 2024-04-12 11:51:22,569 | server.py:171 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2024-04-12 11:51:22,570 | server.py:222 | fit_round 2: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:51:28,782 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:28,804 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,483 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,483 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,484 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,484 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,485 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 32 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,486 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,487 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,487 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,490 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 22 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,491 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,491 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 32 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,491 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 42 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:29,492 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,493 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 22 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,493 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:29,494 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 42 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:30,022 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 96 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:30,022 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 96 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:51:30,024 | server.py:236 | fit_round 2 received 0 results and 10 failures
INFO flwr 2024-04-12 11:51:31,211 | server.py:125 | fit progress: (2, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 24.871402284596115)
INFO flwr 2024-04-12 11:51:31,211 | server.py:171 | evaluate_round 2: no clients selected, cancel
DEBUG flwr 2024-04-12 11:51:31,211 | server.py:222 | fit_round 3: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:51:36,888 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:36,888 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,598 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,599 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,601 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,604 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 1 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,604 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,605 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,605 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,606 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 65 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,608 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 1 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,610 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,610 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,611 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,611 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,612 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 65 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,612 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,613 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 50 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:37,833 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:37,833 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:51:37,835 | server.py:236 | fit_round 3 received 0 results and 10 failures
INFO flwr 2024-04-12 11:51:39,020 | server.py:125 | fit progress: (3, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 32.681097557768226)
INFO flwr 2024-04-12 11:51:39,021 | server.py:171 | evaluate_round 3: no clients selected, cancel
DEBUG flwr 2024-04-12 11:51:39,021 | server.py:222 | fit_round 4: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:51:44,494 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 30 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:44,495 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 30 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,282 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,283 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,284 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,284 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,287 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,287 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,288 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 24 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,290 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,291 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,291 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 71 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,292 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,293 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 29 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,293 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,294 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 71 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,294 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,295 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 29 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:45,801 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 94 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:45,801 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 94 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:51:45,803 | server.py:236 | fit_round 4 received 0 results and 10 failures
INFO flwr 2024-04-12 11:51:46,999 | server.py:125 | fit progress: (4, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 40.66002533771098)
INFO flwr 2024-04-12 11:51:46,999 | server.py:171 | evaluate_round 4: no clients selected, cancel
DEBUG flwr 2024-04-12 11:51:47,000 | server.py:222 | fit_round 5: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:51:52,636 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:52,636 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 44 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,359 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,359 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,360 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,361 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 76 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,363 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 73 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,363 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 15 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,364 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,364 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,366 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,366 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 76 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,367 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,367 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 15 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,368 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,368 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 6 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,368 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,369 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:51:53,886 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:51:53,887 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:51:53,888 | server.py:236 | fit_round 5 received 0 results and 10 failures
INFO flwr 2024-04-12 11:51:55,066 | server.py:125 | fit progress: (5, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 48.72661930182949)
INFO flwr 2024-04-12 11:51:55,066 | server.py:171 | evaluate_round 5: no clients selected, cancel
DEBUG flwr 2024-04-12 11:51:55,066 | server.py:222 | fit_round 6: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:52:00,706 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 68 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:00,722 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 68 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,395 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,395 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,397 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,397 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,397 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,398 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,399 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 8 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,401 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 78 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,401 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 43 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,403 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 78 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,403 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,406 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,407 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 93 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,407 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 54 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,407 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,408 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 93 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:01,954 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:01,954 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 16 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:52:01,955 | server.py:236 | fit_round 6 received 0 results and 10 failures
INFO flwr 2024-04-12 11:52:03,132 | server.py:125 | fit progress: (6, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 56.793166612740606)
INFO flwr 2024-04-12 11:52:03,133 | server.py:171 | evaluate_round 6: no clients selected, cancel
DEBUG flwr 2024-04-12 11:52:03,133 | server.py:222 | fit_round 7: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:52:08,776 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:08,792 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 55 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,503 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,503 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 68 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,504 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,504 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,505 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,507 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,508 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 68 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,508 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 23 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,509 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 46 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,510 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,510 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,510 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,511 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,511 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 23 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,512 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,513 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:09,793 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:09,794 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 53 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:52:09,795 | server.py:236 | fit_round 7 received 0 results and 10 failures
INFO flwr 2024-04-12 11:52:11,012 | server.py:125 | fit progress: (7, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 64.67294855881482)
INFO flwr 2024-04-12 11:52:11,012 | server.py:171 | evaluate_round 7: no clients selected, cancel
DEBUG flwr 2024-04-12 11:52:11,013 | server.py:222 | fit_round 8: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:52:16,546 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 88 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:16,547 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 88 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,271 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 81 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,272 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,273 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,273 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 81 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,275 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,275 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 45 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,276 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,276 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,277 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,277 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,279 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 34 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,279 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,279 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 45 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,280 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 51 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,281 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 20 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,281 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 34 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:17,814 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 93 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:17,815 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 93 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:52:17,816 | server.py:236 | fit_round 8 received 0 results and 10 failures
INFO flwr 2024-04-12 11:52:18,990 | server.py:125 | fit progress: (8, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 72.65093904361129)
INFO flwr 2024-04-12 11:52:18,990 | server.py:171 | evaluate_round 8: no clients selected, cancel
DEBUG flwr 2024-04-12 11:52:18,990 | server.py:222 | fit_round 9: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:52:24,597 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:24,603 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 22 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:24,613 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:24,639 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 22 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,260 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,261 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,264 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 32 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,265 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,266 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 32 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,268 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 84 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,269 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 27 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,269 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 62 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,271 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,271 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,272 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 84 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,273 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 62 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,273 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,273 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 38 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:25,831 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 9 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:25,831 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 9 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:52:25,833 | server.py:236 | fit_round 9 received 0 results and 10 failures
INFO flwr 2024-04-12 11:52:27,028 | server.py:125 | fit progress: (9, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 80.68880349257961)
INFO flwr 2024-04-12 11:52:27,028 | server.py:171 | evaluate_round 9: no clients selected, cancel
DEBUG flwr 2024-04-12 11:52:27,028 | server.py:222 | fit_round 10: strategy sampled 10 clients (out of 100)
ERROR flwr 2024-04-12 11:52:32,655 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:32,671 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 59 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,359 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,361 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 70 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,362 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,363 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323583, ip=10.20.240.14, actor_id=5fbe3faee15d99b18c5f564201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa98fac1810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 28 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,367 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 81 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,368 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 68 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,369 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,369 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323581, ip=10.20.240.14, actor_id=7ad6b4e619c2644853f98af001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fdb93aad6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 81 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,370 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,371 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323578, ip=10.20.240.14, actor_id=5561196ecd7016d3ade5a19001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb774179750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 68 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,373 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 35 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,373 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323585, ip=10.20.240.14, actor_id=357586ba5c00860b7a39ddbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6874dc56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,374 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,374 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323580, ip=10.20.240.14, actor_id=31b8b04074aa068289e8927101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f99981f15a0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 41 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,375 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323577, ip=10.20.240.14, actor_id=0f1d83ea8a194dcc1d3c7f0401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fe2619594e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 35 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,376 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323576, ip=10.20.240.14, actor_id=e1fe1aab270f4cda62e5cdf001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb1c4bd1960>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 11 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 11:52:33,911 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 11:52:33,911 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1323582, ip=10.20.240.14, actor_id=bff4c99e642d8c9408969d6701000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f9fd51c97b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 69 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-50-50_382008_1301826/runtime_resources/working_dir_files/_ray_pkg_ce7684eb240d79e7/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 11:52:33,912 | server.py:236 | fit_round 10 received 0 results and 10 failures
INFO flwr 2024-04-12 11:52:35,086 | server.py:125 | fit progress: (10, 2.302816867828369, {'accuracy': 0.0734, 'data_size': 10000}, 88.74720336962491)
INFO flwr 2024-04-12 11:52:35,087 | server.py:171 | evaluate_round 10: no clients selected, cancel
INFO flwr 2024-04-12 11:52:35,087 | server.py:153 | FL finished in 88.74758442956954
INFO flwr 2024-04-12 11:52:35,087 | app.py:226 | app_fit: losses_distributed []
INFO flwr 2024-04-12 11:52:35,087 | app.py:227 | app_fit: metrics_distributed_fit {}
INFO flwr 2024-04-12 11:52:35,087 | app.py:228 | app_fit: metrics_distributed {}
INFO flwr 2024-04-12 11:52:35,087 | app.py:229 | app_fit: losses_centralized [(0, 2.302816867828369), (1, 2.302816867828369), (2, 2.302816867828369), (3, 2.302816867828369), (4, 2.302816867828369), (5, 2.302816867828369), (6, 2.302816867828369), (7, 2.302816867828369), (8, 2.302816867828369), (9, 2.302816867828369), (10, 2.302816867828369)]
INFO flwr 2024-04-12 11:52:35,087 | app.py:230 | app_fit: metrics_centralized {'accuracy': [(0, 0.0734), (1, 0.0734), (2, 0.0734), (3, 0.0734), (4, 0.0734), (5, 0.0734), (6, 0.0734), (7, 0.0734), (8, 0.0734), (9, 0.0734), (10, 0.0734)], 'data_size': [(0, 10000), (1, 10000), (2, 10000), (3, 10000), (4, 10000), (5, 10000), (6, 10000), (7, 10000), (8, 10000), (9, 10000), (10, 10000)]}
wandb: - 0.000 MB of 0.000 MB uploadedwandb:                                                                                
wandb: 
wandb: Run summary:
wandb: accuracy 0.0734
wandb:     loss 2.30282
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/s2240084/conFEDential/wandb/offline-run-20240412_115048-d95nk9vy
wandb: Find logs at: ./wandb/offline-run-20240412_115048-d95nk9vy/logs
INFO flwr 2024-04-12 11:52:38,569 | run_simulation.py:153 | 
Running with Config
	Simulation
		batch_size: 8
		client_count: 100
		fraction_fit: 0.1
		global_rounds: 10
		local_rounds: 20
		Optimizer: FedAdam
			local: {'lr': [0.15, 0.2, 0.25]}
			global: {'lr': 0.05, 'betas': [0.9, 0.99], 'eps': 1e-08, 'weight_decay': 0.9999}
	Dataset
		name: MNIST
		preprocess_fn:
			def preprocess_fn(element):
			  return {
			    "x": element["image"].reshape(784) / 255.,
			    "y": element["label"]
			  }
			
		splitter:
			alpha: 1.0
			percent_non_iid: 25.0
	Model
		name: Logistic Regression
		criterion: CrossEntropyLoss()
		layers:
			Net(
			  (layers): Sequential(
			    (0): Linear(in_features=784, out_features=10, bias=True)
			    (1): Softmax(dim=-1)
			  )
			)
Using the latest cached version of the dataset since mnist couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'mnist' at .cache/mnist/mnist/1.0.0/b06aab39e05f7bcd9635d18ed25d06eae523c574 (last modified on Tue Apr  2 18:09:57 2024).
wandb: Tracking run with wandb version 0.16.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
INFO flwr 2024-04-12 11:59:42,231 | app.py:178 | Starting Flower simulation, config: ServerConfig(num_rounds=10, round_timeout=None)
[2m[36m(pid=1323577)[0m 2024-04-12 11:51:08.664680: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1323577)[0m 2024-04-12 11:51:08.749833: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1323577)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1323577)[0m 2024-04-12 11:51:10.569597: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[32m [repeated 7x across cluster][0m
2024-04-12 11:59:46,700	INFO worker.py:1621 -- Started a local Ray instance.
2024-04-12 11:59:47,141	INFO packaging.py:518 -- Creating a file package for local directory '/home/s2240084/conFEDential'.
2024-04-12 11:59:47,611	INFO packaging.py:346 -- Pushing file package 'gcs://_ray_pkg_db0eed131f660a0f.zip' (16.22MiB) to Ray cluster...
2024-04-12 11:59:47,666	INFO packaging.py:359 -- Successfully pushed file package 'gcs://_ray_pkg_db0eed131f660a0f.zip'.
INFO flwr 2024-04-12 11:59:57,117 | app.py:213 | Flower VCE: Ray initialized with resources: {'memory': 171278863360.0, 'node:10.20.240.14': 1.0, 'GPU': 1.0, 'object_store_memory': 77690941440.0, 'accelerator_type:RTX': 1.0, 'CPU': 64.0, 'node:__internal_head__': 1.0}
INFO flwr 2024-04-12 11:59:57,118 | app.py:219 | Optimize your simulation with Flower VCE: https://flower.dev/docs/framework/how-to-run-simulations.html
INFO flwr 2024-04-12 11:59:57,118 | app.py:242 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 0.125}
INFO flwr 2024-04-12 11:59:57,131 | app.py:288 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
INFO flwr 2024-04-12 11:59:57,131 | server.py:89 | Initializing global parameters
INFO flwr 2024-04-12 11:59:57,132 | server.py:272 | Using initial parameters provided by strategy
INFO flwr 2024-04-12 11:59:57,132 | server.py:91 | Evaluating initial parameters
INFO flwr 2024-04-12 11:59:58,974 | server.py:94 | initial parameters (loss, other metrics): 2.304152250289917, {'accuracy': 0.0948, 'data_size': 10000}
INFO flwr 2024-04-12 11:59:58,975 | server.py:104 | FL starting
DEBUG flwr 2024-04-12 11:59:58,975 | server.py:222 | fit_round 1: strategy sampled 10 clients (out of 100)
[2m[36m(pid=1330793)[0m 2024-04-12 12:00:02.289878: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[2m[36m(pid=1330793)[0m 2024-04-12 12:00:02.379973: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[2m[36m(pid=1330793)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[2m[36m(pid=1330793)[0m 2024-04-12 12:00:04.255401: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
ERROR flwr 2024-04-12 12:00:13,040 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,057 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 67 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,826 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 1 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,827 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330795, ip=10.20.240.14, actor_id=62039c5ce3993551095de31201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f89479b1690>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330795, ip=10.20.240.14, actor_id=62039c5ce3993551095de31201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f89479b1690>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,828 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 1 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,828 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330795, ip=10.20.240.14, actor_id=62039c5ce3993551095de31201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f89479b1690>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330795, ip=10.20.240.14, actor_id=62039c5ce3993551095de31201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f89479b1690>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,833 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330792, ip=10.20.240.14, actor_id=963c7820cbe1e3ddab02141101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa2ed1a1ab0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330792, ip=10.20.240.14, actor_id=963c7820cbe1e3ddab02141101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa2ed1a1ab0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 2 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,833 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330791, ip=10.20.240.14, actor_id=d0b27ef08c8a2eb312ade0b901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f306572d930>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330791, ip=10.20.240.14, actor_id=d0b27ef08c8a2eb312ade0b901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f306572d930>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,834 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330792, ip=10.20.240.14, actor_id=963c7820cbe1e3ddab02141101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa2ed1a1ab0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330792, ip=10.20.240.14, actor_id=963c7820cbe1e3ddab02141101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa2ed1a1ab0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 2 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,836 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330788, ip=10.20.240.14, actor_id=59ffdab2befb5985a48471b101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f56e0915780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330788, ip=10.20.240.14, actor_id=59ffdab2befb5985a48471b101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f56e0915780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 35 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,837 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330791, ip=10.20.240.14, actor_id=d0b27ef08c8a2eb312ade0b901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f306572d930>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330791, ip=10.20.240.14, actor_id=d0b27ef08c8a2eb312ade0b901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f306572d930>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 61 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,837 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330793, ip=10.20.240.14, actor_id=52822b48685e3653adf986af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb134809720>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330793, ip=10.20.240.14, actor_id=52822b48685e3653adf986af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb134809720>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,838 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330786, ip=10.20.240.14, actor_id=91bf58a55c3a7b818cc1858b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a78c1750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330786, ip=10.20.240.14, actor_id=91bf58a55c3a7b818cc1858b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a78c1750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,839 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330788, ip=10.20.240.14, actor_id=59ffdab2befb5985a48471b101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f56e0915780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330788, ip=10.20.240.14, actor_id=59ffdab2befb5985a48471b101000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f56e0915780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 35 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,840 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 40 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:13,840 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330793, ip=10.20.240.14, actor_id=52822b48685e3653adf986af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb134809720>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330793, ip=10.20.240.14, actor_id=52822b48685e3653adf986af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fb134809720>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 74 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,841 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330786, ip=10.20.240.14, actor_id=91bf58a55c3a7b818cc1858b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a78c1750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330786, ip=10.20.240.14, actor_id=91bf58a55c3a7b818cc1858b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f27a78c1750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 83 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:13,841 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330789, ip=10.20.240.14, actor_id=165b85aa068c7cfd5e9e687d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f200699d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 40 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
ERROR flwr 2024-04-12 12:00:14,288 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 33 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)

ERROR flwr 2024-04-12 12:00:14,288 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit
    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train
    optimizer = run_config.get_optimizer(net.parameters())
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer
    return self.simulation.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance
    return self.optimizer.get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance
    return self.get_strategy().get_optimizer_instance(parameters)
  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance
    return torch.optim.SGD(parameters, **self.kwargs["local"])
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__
    if lr < 0.0:
TypeError: '<' not supported between instances of 'list' and 'float'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1330794, ip=10.20.240.14, actor_id=4670860d56a28f16cc2707b201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f73669c1570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 33 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 105, in fit\n    new_parameters, data_size, config = strategy.train(parameters, train_loaders[self.cid], run_config, config)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 94, in train\n    optimizer = run_config.get_optimizer(net.parameters())\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Config.py", line 98, in get_optimizer\n    return self.simulation.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 141, in get_optimizer_instance\n    return self.optimizer.get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/utils/configs/Simulation.py", line 53, in get_optimizer_instance\n    return self.get_strategy().get_optimizer_instance(parameters)\n  File "/tmp/ray/session_2024-04-12_11-59-44_169975_1301826/runtime_resources/working_dir_files/_ray_pkg_db0eed131f660a0f/src/training/strategies/FedAdam.py", line 80, in get_optimizer_instance\n    return torch.optim.SGD(parameters, **self.kwargs["local"])\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/optim/sgd.py", line 14, in __init__\n    if lr < 0.0:\nTypeError: \'<\' not supported between instances of \'list\' and \'float\'\n',)
DEBUG flwr 2024-04-12 12:00:14,290 | server.py:236 | fit_round 1 received 0 results and 10 failures
INFO flwr 2024-04-12 12:00:15,488 | server.py:125 | fit progress: (1, 2.304152250289917, {'accuracy': 0.0948, 'data_size': 10000}, 16.513422900345176)
INFO flwr 2024-04-12 12:00:15,489 | server.py:171 | evaluate_round 1: no clients selected, cancel
DEBUG flwr 2024-04-12 12:00:15,489 | server.py:222 | fit_round 2: strategy sampled 10 clients (out of 100)
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd-ctit084: error: *** JOB 280508 ON ctit084 CANCELLED AT 2024-04-12T12:00:18 ***
slurmstepd-ctit084: error: *** STEP 280508.0 ON ctit084 CANCELLED AT 2024-04-12T12:00:18 ***
*** SIGTERM received at time=1712916018 on cpu 21 ***
PC: @     0x7f8e786fd454  (unknown)  do_futex_wait.constprop.0
    @     0x7f8e78b60090  (unknown)  (unknown)
    @     0x563900000000  (unknown)  (unknown)
[2024-04-12 12:00:18,632 E 1301826 1301826] logging.cc:361: *** SIGTERM received at time=1712916018 on cpu 21 ***
[2024-04-12 12:00:18,632 E 1301826 1301826] logging.cc:361: PC: @     0x7f8e786fd454  (unknown)  do_futex_wait.constprop.0
[2024-04-12 12:00:18,636 E 1301826 1301826] logging.cc:361:     @     0x7f8e78b60090  (unknown)  (unknown)
[2024-04-12 12:00:18,640 E 1301826 1301826] logging.cc:361:     @     0x563900000000  (unknown)  (unknown)
