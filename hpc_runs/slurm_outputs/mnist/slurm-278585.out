ctit082
	Adding python 3.10.7 (ubuntu 20.04) to your environment
2024-04-02 14:33:01.900656: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-02 14:33:01.900656: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-02 14:33:03.734611: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-04-02 14:33:03.734610: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Using the latest cached version of the dataset since mnist couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'mnist' at .cache/mnist/mnist/1.0.0/b06aab39e05f7bcd9635d18ed25d06eae523c574 (last modified on Tue Apr  2 11:37:01 2024).
Using the latest cached version of the dataset since mnist couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'mnist' at .cache/mnist/mnist/1.0.0/b06aab39e05f7bcd9635d18ed25d06eae523c574 (last modified on Tue Apr  2 11:37:01 2024).
wandb: Tracking run with wandb version 0.16.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
INFO flwr 2024-04-02 14:40:17,241 | app.py:178 | Starting Flower simulation, config: ServerConfig(num_rounds=10, round_timeout=None)
2024-04-02 14:40:20,016	INFO worker.py:1621 -- Started a local Ray instance.
2024-04-02 14:40:21,865	INFO packaging.py:518 -- Creating a file package for local directory '/home/s2240084/conFEDential'.
2024-04-02 14:40:22,060	INFO packaging.py:346 -- Pushing file package 'gcs://_ray_pkg_0bb509c19ebcf1c8.zip' (7.14MiB) to Ray cluster...
2024-04-02 14:40:22,088	INFO packaging.py:359 -- Successfully pushed file package 'gcs://_ray_pkg_0bb509c19ebcf1c8.zip'.
INFO flwr 2024-04-02 14:40:28,485 | app.py:213 | Flower VCE: Ray initialized with resources: {'CPU': 64.0, 'object_store_memory': 80388560486.0, 'accelerator_type:TITAN': 1.0, 'memory': 177573307802.0, 'GPU': 1.0, 'node:10.20.240.12': 1.0, 'node:__internal_head__': 1.0}
INFO flwr 2024-04-02 14:40:28,485 | app.py:219 | Optimize your simulation with Flower VCE: https://flower.dev/docs/framework/how-to-run-simulations.html
INFO flwr 2024-04-02 14:40:28,486 | app.py:242 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 0.125}
INFO flwr 2024-04-02 14:40:28,505 | app.py:288 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
INFO flwr 2024-04-02 14:40:28,506 | server.py:89 | Initializing global parameters
INFO flwr 2024-04-02 14:40:28,507 | server.py:272 | Using initial parameters provided by strategy
INFO flwr 2024-04-02 14:40:28,507 | server.py:91 | Evaluating initial parameters
INFO flwr 2024-04-02 14:40:31,913 | server.py:94 | initial parameters (loss, other metrics): 2.302588701248169, {'accuracy': 0.0679, 'data_size': 10000}
INFO flwr 2024-04-02 14:40:31,914 | server.py:104 | FL starting
DEBUG flwr 2024-04-02 14:40:31,914 | server.py:222 | fit_round 1: strategy sampled 10 clients (out of 100)
[2m[36m(pid=1776755)[0m 2024-04-02 14:40:32.371974: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[2m[36m(pid=1776755)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[2m[36m(pid=1776747)[0m 2024-04-02 14:40:33.965733: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
wandb: Tracking run with wandb version 0.16.5
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
INFO flwr 2024-04-02 14:40:36,783 | app.py:178 | Starting Flower simulation, config: ServerConfig(num_rounds=10, round_timeout=None)
2024-04-02 14:40:40,802	INFO worker.py:1621 -- Started a local Ray instance.
2024-04-02 14:40:41,055	INFO packaging.py:518 -- Creating a file package for local directory '/home/s2240084/conFEDential'.
[2m[36m(DefaultActor pid=1776756)[0m /home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py:183: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
[2m[36m(DefaultActor pid=1776756)[0m   return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
[2m[36m(pid=1776758)[0m 2024-04-02 14:40:32.688048: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[2m[36m(pid=1776758)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1776745)[0m 2024-04-02 14:40:34.508321: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[32m [repeated 7x across cluster][0m
2024-04-02 14:40:41,314	INFO packaging.py:346 -- Pushing file package 'gcs://_ray_pkg_540656939f1f5117.zip' (7.14MiB) to Ray cluster...
2024-04-02 14:40:41,329	INFO packaging.py:359 -- Successfully pushed file package 'gcs://_ray_pkg_540656939f1f5117.zip'.
ERROR flwr 2024-04-02 14:40:43,952 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776748, ip=10.20.240.12, actor_id=2c7e00e0a6cb452a7723377601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd509525570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776748, ip=10.20.240.12, actor_id=2c7e00e0a6cb452a7723377601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd509525570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:43,952 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776748, ip=10.20.240.12, actor_id=2c7e00e0a6cb452a7723377601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd509525570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776748, ip=10.20.240.12, actor_id=2c7e00e0a6cb452a7723377601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd509525570>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:43,954 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776750, ip=10.20.240.12, actor_id=16bafadb35304ca3b663584b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6740589840>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776750, ip=10.20.240.12, actor_id=16bafadb35304ca3b663584b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6740589840>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:43,958 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776750, ip=10.20.240.12, actor_id=16bafadb35304ca3b663584b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6740589840>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776750, ip=10.20.240.12, actor_id=16bafadb35304ca3b663584b01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f6740589840>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:43,955 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:43,959 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:43,957 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776758, ip=10.20.240.12, actor_id=807237886a032d5a86c12ac901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f7274311660>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776758, ip=10.20.240.12, actor_id=807237886a032d5a86c12ac901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f7274311660>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:43,959 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776758, ip=10.20.240.12, actor_id=807237886a032d5a86c12ac901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f7274311660>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776758, ip=10.20.240.12, actor_id=807237886a032d5a86c12ac901000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f7274311660>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:43,956 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776755, ip=10.20.240.12, actor_id=70808ee3e262515c1256e15801000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f3a7dcd1780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776755, ip=10.20.240.12, actor_id=70808ee3e262515c1256e15801000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f3a7dcd1780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:43,960 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776755, ip=10.20.240.12, actor_id=70808ee3e262515c1256e15801000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f3a7dcd1780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776755, ip=10.20.240.12, actor_id=70808ee3e262515c1256e15801000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f3a7dcd1780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:43,958 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:43,960 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776753, ip=10.20.240.12, actor_id=a9afacd24e926c1fdef8452001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fd4e4799750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:43,955 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:43,961 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:44,681 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:44,681 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776756, ip=10.20.240.12, actor_id=4594b138517d94838d3b2d7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f88740e5870>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
INFO flwr 2024-04-02 14:40:48,016 | app.py:213 | Flower VCE: Ray initialized with resources: {'CPU': 64.0, 'object_store_memory': 78602161766.0, 'GPU': 1.0, 'accelerator_type:TITAN': 1.0, 'memory': 173405044122.0, 'node:10.20.240.12': 1.0, 'node:__internal_head__': 1.0}
INFO flwr 2024-04-02 14:40:48,016 | app.py:219 | Optimize your simulation with Flower VCE: https://flower.dev/docs/framework/how-to-run-simulations.html
INFO flwr 2024-04-02 14:40:48,016 | app.py:242 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 0.125}
INFO flwr 2024-04-02 14:40:48,035 | app.py:288 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
INFO flwr 2024-04-02 14:40:48,036 | server.py:89 | Initializing global parameters
INFO flwr 2024-04-02 14:40:48,036 | server.py:272 | Using initial parameters provided by strategy
INFO flwr 2024-04-02 14:40:48,036 | server.py:91 | Evaluating initial parameters
[2m[36m(DefaultActor pid=1776747)[0m /home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py:183: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)[32m [repeated 6x across cluster][0m
[2m[36m(DefaultActor pid=1776747)[0m   return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)[32m [repeated 6x across cluster][0m
ERROR flwr 2024-04-02 14:40:49,078 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776747, ip=10.20.240.12, actor_id=03fc75e9293ea4e4d2dca5af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa0261dd9f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776747, ip=10.20.240.12, actor_id=03fc75e9293ea4e4d2dca5af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa0261dd9f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:49,079 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776747, ip=10.20.240.12, actor_id=03fc75e9293ea4e4d2dca5af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa0261dd9f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776747, ip=10.20.240.12, actor_id=03fc75e9293ea4e4d2dca5af01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa0261dd9f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:40:51,675 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1776745, ip=10.20.240.12, actor_id=d03d1f1fe3fd892c96ed8e6201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f4fe689d780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776745, ip=10.20.240.12, actor_id=d03d1f1fe3fd892c96ed8e6201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f4fe689d780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:40:51,676 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1776745, ip=10.20.240.12, actor_id=d03d1f1fe3fd892c96ed8e6201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f4fe689d780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1776745, ip=10.20.240.12, actor_id=d03d1f1fe3fd892c96ed8e6201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f4fe689d780>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-17_318000_1773881/runtime_resources/working_dir_files/_ray_pkg_0bb509c19ebcf1c8/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
DEBUG flwr 2024-04-02 14:40:51,677 | server.py:236 | fit_round 1 received 0 results and 10 failures
ERROR flwr 2024-04-02 14:40:51,678 | app.py:313 | list index out of range
ERROR flwr 2024-04-02 14:40:51,681 | app.py:314 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/app.py", line 308, in start_simulation
    hist = run_fl(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/server/app.py", line 225, in run_fl
    hist = server.fit(num_rounds=config.num_rounds, timeout=config.round_timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/server/server.py", line 109, in fit
    res_fit = self.fit_round(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/server/server.py", line 248, in fit_round
    ] = self.strategy.aggregate_fit(server_round, results, failures)
  File "/home/s2240084/conFEDential/src/server_aggregation_strategies/capture_generator.py", line 81, in aggregate_fit
    self._capture_parameters(captured_parameters)
  File "/home/s2240084/conFEDential/src/server_aggregation_strategies/capture_generator.py", line 35, in _capture_parameters
    captures = self._load_npz_file(captured_parameters)
  File "/home/s2240084/conFEDential/src/server_aggregation_strategies/capture_generator.py", line 61, in _load_npz_file
    list(captured_parameters.values())[0]]
IndexError: list index out of range

ERROR flwr 2024-04-02 14:40:51,681 | app.py:315 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 0.125} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 0.125}.
Take a look at the Flower simulation examples for guidance <https://flower.dev/docs/framework/how-to-run-simulations.html>.
[2m[36m(pid=1779807)[0m 2024-04-02 14:40:51.778070: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[2m[36m(pid=1779807)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
wandb: - 0.000 MB of 0.000 MB uploadedwandb:                                                                                
wandb: 
wandb: Run summary:
wandb: accuracy 0.0679
wandb:     loss 2.30259
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/s2240084/conFEDential/wandb/offline-run-20240402_144016-g4e0qd7t
wandb: Find logs at: ./wandb/offline-run-20240402_144016-g4e0qd7t/logs
[2m[36m(pid=1779804)[0m 2024-04-02 14:40:53.480033: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
INFO flwr 2024-04-02 14:40:55,717 | server.py:94 | initial parameters (loss, other metrics): 2.3025906085968018, {'accuracy': 0.146, 'data_size': 10000}
INFO flwr 2024-04-02 14:40:55,717 | server.py:104 | FL starting
DEBUG flwr 2024-04-02 14:40:55,718 | server.py:222 | fit_round 1: strategy sampled 10 clients (out of 100)
[2m[36m(DefaultActor pid=1779808)[0m /home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py:183: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
[2m[36m(DefaultActor pid=1779808)[0m   return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
[2m[36m(pid=1779808)[0m 2024-04-02 14:40:52.012760: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[2m[36m(pid=1779808)[0m To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.[32m [repeated 7x across cluster][0m
[2m[36m(pid=1779808)[0m 2024-04-02 14:40:53.691057: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[32m [repeated 7x across cluster][0m
ERROR flwr 2024-04-02 14:41:03,499 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:03,510 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 21 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:04,318 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:04,318 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779805, ip=10.20.240.12, actor_id=0ae2f81ee97ecb351ce08d0e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7faf780bd7e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779805, ip=10.20.240.12, actor_id=0ae2f81ee97ecb351ce08d0e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7faf780bd7e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:04,319 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 80 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:04,320 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779805, ip=10.20.240.12, actor_id=0ae2f81ee97ecb351ce08d0e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7faf780bd7e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779805, ip=10.20.240.12, actor_id=0ae2f81ee97ecb351ce08d0e01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7faf780bd7e0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 64 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:04,320 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779804, ip=10.20.240.12, actor_id=717d78dd788d9db6da1fc5f501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f347e3dd9c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779804, ip=10.20.240.12, actor_id=717d78dd788d9db6da1fc5f501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f347e3dd9c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:04,322 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779804, ip=10.20.240.12, actor_id=717d78dd788d9db6da1fc5f501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f347e3dd9c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779804, ip=10.20.240.12, actor_id=717d78dd788d9db6da1fc5f501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f347e3dd9c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 85 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:04,324 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779803, ip=10.20.240.12, actor_id=577b91a61f2a3bdeab3c0ae601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa397b3d7b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779803, ip=10.20.240.12, actor_id=577b91a61f2a3bdeab3c0ae601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa397b3d7b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:04,324 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779803, ip=10.20.240.12, actor_id=577b91a61f2a3bdeab3c0ae601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa397b3d7b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779803, ip=10.20.240.12, actor_id=577b91a61f2a3bdeab3c0ae601000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7fa397b3d7b0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 95 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:04,325 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:04,325 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779808, ip=10.20.240.12, actor_id=73d59254ebea7f34cf7ff32401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f54e87cd750>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 10 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:04,872 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:04,873 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779807, ip=10.20.240.12, actor_id=0777bb3598fe266becb912c401000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f1f25d1da20>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 0 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:04,890 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779802, ip=10.20.240.12, actor_id=687e96f966fe2eb89bdba1d001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f25aec8d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779802, ip=10.20.240.12, actor_id=687e96f966fe2eb89bdba1d001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f25aec8d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:04,890 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779802, ip=10.20.240.12, actor_id=687e96f966fe2eb89bdba1d001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f25aec8d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779802, ip=10.20.240.12, actor_id=687e96f966fe2eb89bdba1d001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f25aec8d6f0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 89 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
[2m[36m(DefaultActor pid=1779801)[0m /home/s2240084/conFEDential/venv/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py:183: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)[32m [repeated 6x across cluster][0m
[2m[36m(DefaultActor pid=1779801)[0m   return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)[32m [repeated 6x across cluster][0m
ERROR flwr 2024-04-02 14:41:05,831 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779801, ip=10.20.240.12, actor_id=a9b24f35e01d4799e4e6cab001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f45e4ae56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779801, ip=10.20.240.12, actor_id=a9b24f35e01d4799e4e6cab001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f45e4ae56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:05,831 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779801, ip=10.20.240.12, actor_id=a9b24f35e01d4799e4e6cab001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f45e4ae56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779801, ip=10.20.240.12, actor_id=a9b24f35e01d4799e4e6cab001000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f45e4ae56c0>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 49 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
ERROR flwr 2024-04-02 14:41:06,585 | ray_client_proxy.py:161 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 151, in _submit_job
    res, updated_context = self.actor_pool.get_client_result(self.cid, timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 425, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 306, in _fetch_future_result
    res_cid, res, updated_context = ray.get(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 24, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2524, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=1779798, ip=10.20.240.12, actor_id=b525477ec64c684a28dabc7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f747c795810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779798, ip=10.20.240.12, actor_id=b525477ec64c684a28dabc7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f747c795810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)

ERROR flwr 2024-04-02 14:41:06,585 | ray_client_proxy.py:162 | [36mray::DefaultActor.run()[39m (pid=1779798, ip=10.20.240.12, actor_id=b525477ec64c684a28dabc7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f747c795810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit
    return maybe_call_fit(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit
    new_parameters, data_size = helper.train(
  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train
    print(old_parameters, new_parameters, old_parameters == new_parameters)
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=1779798, ip=10.20.240.12, actor_id=b525477ec64c684a28dabc7c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x7f747c795810>)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 90, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client run.\n\tClient 92 crashed when the DefaultActor was running its run.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 76, in run\n    job_results = job_fn(client)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 207, in fit\n    return maybe_call_fit(\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit\n    return client.fit(fit_ins)\n  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit\n    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore\n  File "/home/s2240084/conFEDential/src/run_simulation.py", line 87, in fit\n    new_parameters, data_size = helper.train(\n  File "/tmp/ray/session_2024-04-02_14-40-36_859943_1773879/runtime_resources/working_dir_files/_ray_pkg_540656939f1f5117/src/training/helper.py", line 66, in train\n    print(old_parameters, new_parameters, old_parameters == new_parameters)\nValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n',)
DEBUG flwr 2024-04-02 14:41:06,587 | server.py:236 | fit_round 1 received 0 results and 10 failures
ERROR flwr 2024-04-02 14:41:06,588 | app.py:313 | list index out of range
ERROR flwr 2024-04-02 14:41:06,590 | app.py:314 | Traceback (most recent call last):
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/simulation/app.py", line 308, in start_simulation
    hist = run_fl(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/server/app.py", line 225, in run_fl
    hist = server.fit(num_rounds=config.num_rounds, timeout=config.round_timeout)
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/server/server.py", line 109, in fit
    res_fit = self.fit_round(
  File "/home/s2240084/conFEDential/venv/lib/python3.10/site-packages/flwr/server/server.py", line 248, in fit_round
    ] = self.strategy.aggregate_fit(server_round, results, failures)
  File "/home/s2240084/conFEDential/src/server_aggregation_strategies/capture_generator.py", line 81, in aggregate_fit
    self._capture_parameters(captured_parameters)
  File "/home/s2240084/conFEDential/src/server_aggregation_strategies/capture_generator.py", line 35, in _capture_parameters
    captures = self._load_npz_file(captured_parameters)
  File "/home/s2240084/conFEDential/src/server_aggregation_strategies/capture_generator.py", line 61, in _load_npz_file
    list(captured_parameters.values())[0]]
IndexError: list index out of range

ERROR flwr 2024-04-02 14:41:06,590 | app.py:315 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 0.125} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 0.125}.
Take a look at the Flower simulation examples for guidance <https://flower.dev/docs/framework/how-to-run-simulations.html>.
wandb: - 0.000 MB of 0.000 MB uploadedwandb:                                                                                
wandb: 
wandb: Run summary:
wandb: accuracy 0.146
wandb:     loss 2.30259
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/s2240084/conFEDential/wandb/offline-run-20240402_144036-pc5joxgo
wandb: Find logs at: ./wandb/offline-run-20240402_144036-pc5joxgo/logs
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd-ctit082: error: *** STEP 278585.0 ON ctit082 CANCELLED AT 2024-04-02T14:45:19 ***
*** SIGTERM received at time=1712061919 on cpu 10 ***
slurmstepd-ctit082: error: *** STEP 278585.1 ON ctit082 CANCELLED AT 2024-04-02T14:45:19 ***
*** SIGTERM received at time=1712061919 on cpu 6 ***
slurmstepd-ctit082: error: *** JOB 278585 ON ctit082 CANCELLED AT 2024-04-02T14:45:19 ***
PC: @     0x7fa23bf2d99f  (unknown)  poll
    @     0x7fa23be5e090  (unknown)  (unknown)
    @ ... and at least 7 more frames
[2024-04-02 14:45:19,359 E 1773879 1773879] logging.cc:361: *** SIGTERM received at time=1712061919 on cpu 10 ***
[2024-04-02 14:45:19,359 E 1773879 1773879] logging.cc:361: PC: @     0x7fa23bf2d99f  (unknown)  poll
[2024-04-02 14:45:19,359 E 1773879 1773879] logging.cc:361:     @     0x7fa23be5e090  (unknown)  (unknown)
[2024-04-02 14:45:19,359 E 1773879 1773879] logging.cc:361:     @ ... and at least 7 more frames
Loaded 168 configs, running...
PC: @     0x7f6c7726c99f  (unknown)  poll
    @     0x7f6c7719d090  (unknown)  (unknown)
    @ ... and at least 7 more frames
[2024-04-02 14:45:19,360 E 1773881 1773881] logging.cc:361: *** SIGTERM received at time=1712061919 on cpu 6 ***
[2024-04-02 14:45:19,360 E 1773881 1773881] logging.cc:361: PC: @     0x7f6c7726c99f  (unknown)  poll
[2024-04-02 14:45:19,361 E 1773881 1773881] logging.cc:361:     @     0x7f6c7719d090  (unknown)  (unknown)
[2024-04-02 14:45:19,361 E 1773881 1773881] logging.cc:361:     @ ... and at least 7 more frames
Loaded 168 configs, running...
